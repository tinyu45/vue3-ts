<template>
  <div ref="container" class="three-container">
    <a-row class="info-pack">
      <a-col :span="12">
        <a-typography-title :level="3" style="color: white">
          ä¸€ä¸ªåœ°çƒ ğŸŒ
        </a-typography-title>
      </a-col>
      <a-col :span="12" class="back-container">
        <a-button type="primary" @click="jump('/')">back</a-button>
      </a-col>
    </a-row>
  </div>
</template>
<script lang="ts">
import { defineComponent, onMounted, ref, unref, onBeforeUnmount } from "vue";
import { useCommon } from "@/utils/common";
import { SmileOutlined, DownOutlined } from "@ant-design/icons-vue";
import * as THREE from "three";
import { OBJLoader } from "three/examples/jsm/loaders/OBJLoader"; // objæ–‡ä»¶åŠ è½½
import { MTLLoader } from "three/examples/jsm/loaders/MTLLoader"; // æè´¨åŠ è½½
export default defineComponent({
  setup() {
    const container = ref(null);
    const { jumpTo: jump } = useCommon();
    let renderer: any, scene: any, camera: any, light: any, ball: any;

    /**
     * è‡ªåŠ¨å¾ªç¯æ¸²æŸ“
     */
    function render() {
      // ball.rotation.y = (ball.rotation.y + 0.01) % (Math.PI * 2);
      renderer.render(scene, camera);
      requestAnimationFrame(render);
    }
    /**
     * åˆå§‹åŒ–æ–¹æ³•
     */
    function init() {
      renderer = new THREE.WebGLRenderer(); // æ¸²æŸ“å™¨
      renderer.setSize(window.innerWidth, window.innerHeight);
      const contant: any = unref(container);
      contant.appendChild(renderer.domElement);

      renderer.setClearColor(0x000000); // è®¾ç½®èƒŒæ™¯è‰²
      scene = new THREE.Scene(); // åˆ›å»ºåœºæ™¯
      // åˆ›å»ºç›¸æœº å¹¶è®¾ç½®ä½ç½®
      camera = new THREE.PerspectiveCamera(
        45,
        window.innerWidth / window.innerHeight,
        1,
        1000
      );
      camera.position.set(0, 0, 5);
      scene.add(camera);

      // åˆ›å»ºä¸€ä¸ª xã€yã€zæ–¹å‘ä¸º 1ã€2ã€3,é¢œè‰²ä¸º çº¢è‰² çš„çŸ©å½¢
      //   var cube = new THREE.Mesh(
      //     new THREE.BoxGeometry(1, 2, 3, 20, 20, 30),
      //     new THREE.MeshBasicMaterial({
      //       color: 0xcccccc,
      //       wireframe: true // è¿™é‡Œè¿™å¥ï¼Œè¦åŠ 
      //     })
      //   );
      //   scene.add(cube);

      // æ·»åŠ çƒä½“ ,  çº¢è‰²   è¿™é‡Œçš„ä¸‰ä¸ªå‚æ•°æ˜¯(åŠå¾„ã€ç»åº¦ä¸Šçš„åˆ‡ç‰‡æ•°ï¼Œçº¬åº¦ä¸Šçš„åˆ‡ç‰‡æ•°)ã€‚ç»çº¬åº¦æ•°æ®è¶Šå¤§åœ†è¶Šæ˜¯ç²¾ç»†(å…±7ä¸ªå‚æ•°)
      //   var loader = new THREE.TextureLoader();
      //   loader.load("/img/map.jpg", (texture: any) => {
      //     console.log(texture);
      //   });

      ball = new THREE.Mesh(
        new THREE.SphereGeometry(3, 20, 30),
        new THREE.MeshBasicMaterial({
          map: new THREE.TextureLoader().load("/img/map.jpg")
        })
      );
      // åˆ‡å›¾æ¸²æŸ“
      // new THREE.MeshBasicMaterial({
      //   color: 0xff0000,
      //   wireframe: true
      // })
      // scene.add(ball);

      // camera.position.set(0, 0, 5);
      //   camera.position.set(-2, -4, 5);
      //   camera.lookAt(new THREE.Vector3(0, 0, 0));

      camera.position.set(0, 0, 10);

      render();
    }

    function clear() {
      renderer = null;
      camera = null;
      scene = null;
      ball = null;
    }

    onMounted(() => {
      init();
    });

    /**
     * æ¸…é™¤å†…å­˜å ç”¨
     */
    onBeforeUnmount(() => {
      clear();
    });

    return {
      container,
      jump
    };
  }
});
</script>
<style lang="less" scoped>
.three-container {
  width: 100%;
  height: 100vh;
  position: relative;
  // background: blue;
  .info-pack {
    position: fixed;
    width: 100%;
    padding: 10px 10px 0;
    background-image: linear-gradient(135deg, #1852a8 10%, #92ffc0 100%);
    opacity: 0.8;
    .back-container {
      text-align: right;
    }
  }
}
</style>
